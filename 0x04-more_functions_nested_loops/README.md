more nested loops, more ffunctions
